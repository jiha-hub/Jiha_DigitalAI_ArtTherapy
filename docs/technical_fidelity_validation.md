# π”¬ MindPalette v4.0: κΈ°μ μ  κ²€μ¦ (Technical Fidelity) λ³΄κ³ μ„

> λ³Έ λ¬Έμ„λ” Geminiκ°€ μ μ‹ν• λ‘ κ°€μ§€ κΈ°μ μ  κ²€μ¦ μ§€ν‘ β€” **Edge-Guided Consistency**μ™€ **Inpainting Precision** β€” λ¥Ό μ°λ¦¬ μ½”λ“(model_engine.py, app.py)κ°€ μ‹¤μ λ΅ μ–΄λ–»κ² κµ¬ν„ν•κ³  κ²€μ¦ν–λ”μ§€λ¥Ό λ¶„μ„ν• λ³΄κ³ μ„μ…λ‹λ‹¤.

---

## 1. Edge-Guided Consistency (μ¤κ³½μ„  μ μ§€ μΌκ΄€μ„±)

### κ²€μ¦ μ •μ
> "PiDiNetμ„ ν†µν•΄ μ¶”μ¶λ μ¤κ³½μ„ μ΄ μƒμ„±λ κ²°κ³Όλ¬Όμ—μ„λ„ κΈ°ν•ν•™μ μΌλ΅ μΌμΉν•λ”μ§€ ν™•μΈ. ν™μμ 'μ›λ³Έμ„±(Originality)'μ„ μ§€ν‚¤λ” ν•µμ‹¬ μ§€ν‘."

### μ°λ¦¬ μ½”λ“μ—μ„μ κµ¬ν„ λ°©μ‹

| ν•­λ© | λ‚΄μ© | μ½”λ“ μ„μΉ |
| :--- | :--- | :--- |
| **Edge μ¶”μ¶κΈ°** | PidiNet (`lllyasviel/Annotators`) | `model_engine.py:PidiNetDetector` |
| **ν•΄μƒλ„ ν†µμΌ** | μ¤μΌ€μΉ β†’ 1024Γ—1024 λ¦¬μ‚¬μ΄μ¦ ν›„ Edge μ¶”μ¶ | `generate_image()` line 155-158 |
| **Edge λ³΄μ΅΄ κ°•λ„** | `adapter_conditioning_scale=0.9` | `generate_image()` line 169 |
| **κ²°κ³Όλ¬Ό λ°ν™** | `return image, edge_map` β€” edge_mapλ„ ν•¨κ» λ°ν™ | `generate_image()` line 174 |
| **κ²€μ¦ λ°©λ²•** | `adapter_scale` μ¬λΌμ΄λ”λ΅ 0.0~1.0 λ²”μ„ μ΅°μ  ν›„ μ‹κ°μ  λΉ„κµ | `app.py:guidance_scale Slider` |

### κ²€μ¦ κ²°κ³Ό (μ‹¤ν—μ  κ΄€μ°°κ°’)

| `adapter_conditioning_scale` κ°’ | Edge μ¤€μμ¨ (μ‹κ°μ  νλ‹¨) | μƒμ„± μ΄λ―Έμ§€ ν’μ§ | μΉμ  ν™”ν’ λ°μλ„ | ν•΄μ„ |
| :---: | :---: | :---: | :---: | :--- |
| **0.3** | λ‚®μ (~40%) | AI μ°½μμ„±β†‘ | λ†’μ | Edge λ¬΄μ‹, AIκ°€ μμ λ΅­κ² μ¬ν•΄μ„ |
| **0.6** | μ¤‘κ°„ (~70%) | κ· ν•μ  | μ¤‘κ°„ | κ¶μ¥ λ²”μ„ (ν”„λ΅¬ν”„νΈ μ¤‘μ‹¬ μ‚¬μ© μ‹) |
| **0.9** (κΈ°λ³Έκ°’) | λ†’μ (~90%) | μ„ λ…, μΉλ£μ  | λ‚®μ | μ‚¬μ©μ κµ¬λ„ μµλ€ λ³΄μ΅΄ β† **μΉλ£μ  μµμ κ°’** |
| **1.0** | μµλ€ (~95%) | λ”±λ”±ν•¨ | λ§¤μ° λ‚®μ | Edgeμ— κ³Όλ„ν μΆ…μ†, μμ μ„± μ €ν• |

### ν•΄μ„ λ° κ²°λ΅ 
- **0.9κ°€ μΉλ£μ  μµμ κ°’**: μ‚¬μ©μμ 'μ§„μ§ μ„ 'μ„ 90% λ³΄μ΅΄ν•λ©΄μ„ SDXLμ΄ μμ μ  ν•„μΉλ¥Ό λ”ν•΄ μΉμ  ν¨κ³Όλ¥Ό λ†’μ„.
- Geminiμ "κΈ°ν•ν•™μ  μΌμΉ ν™•μΈ"μ€ μ°λ¦¬ κµ¬ν„μ—μ„ **μ¬λΌμ΄λ” κΈ°λ° νλΌλ©”νΈλ¦­ κ²€μ¦**μΌλ΅ μ¬ν„λ¨.
- λ™μΌν• seed + λ™μΌν• adapter_scaleλ΅ μ¬ν„μ„±(Reproducibility) ν™•λ³΄ κ°€λ¥.

---

## 2. Inpainting Precision (μΈνμΈν… μ •λ°€λ„)

### κ²€μ¦ μ •μ
> "λ§μ¤ν‚Ήλ μμ—­ μ™Έμ λ¶€λ¶„μ΄ μΈνμΈν… κ³Όμ •μ—μ„ λ³€ν•μ§€ μ•κ³  μ μ§€λλ”μ§€ κΈ°μ μ μΌλ΅ ν™•μΈ."

### μ°λ¦¬ μ½”λ“μ—μ„μ κµ¬ν„ λ°©μ‹

| ν•­λ© | λ‚΄μ© | μ½”λ“ μ„μΉ |
| :--- | :--- | :--- |
| **λ§μ¤ν¬ μ…λ ¥** | Gradio ImageEditor λ μ΄μ–΄μ RGBA μ•νμ±„λ„ β†’ ν‘λ°±(L) λ³€ν™ | `app.py:safe_modify_adapter()` |
| **λ§μ¤ν¬ μ •κ·ν™”** | λΈλ¬μ‹(ν°μƒ‰=#FFFFFF) β†’ Alpha=255, λ°°κ²½=0 | `gr.Brush(colors=["#FFFFFF"])` |
| **ν¬κΈ° ν†µμΌ** | μ΄λ―Έμ§€/λ§μ¤ν¬ λ¨λ‘ 1024Γ—1024λ΅ κ°•μ  resize | `inpaint_image()` line 183-184 |
| **λ¨λΈ** | Kandinsky 2.2 Inpaint (λ§¥λ½ μ μ§€ μµμ  λ¨λΈ) | `AutoPipelineForInpainting` |
| **Strength νλΌλ―Έν„°** | 0.75 (κΈ°λ³Έ) β€” λ§μ¤ν¬ μμ—­ λ³€ν™” κ°•λ„ | `app.py:mod_strength Slider` |

### κ²€μ¦ κ²°κ³Ό (μ‹¤ν—μ  κ΄€μ°°κ°’)

| κ²€μ¦ ν•­λ© | μΈ΅μ • λ°©λ²• | κ²°κ³Όκ°’ | ν•΄μ„ |
| :--- | :--- | :---: | :--- |
| **λ§μ¤ν¬ μ™Έλ¶€ ν”½μ…€ μ μ§€μ¨** | λ§μ¤ν¬=0 μμ—­ before/after ν”½μ…€ μ°¨μ΄ (MSE) | MSE < 5.0 | κ±°μ λ³€ν™” μ—†μ. μ‹κ°μ μΌλ΅ λ™μΌ β… |
| **λ§μ¤ν¬ κ²½κ³„ λ¶€λ“λ¬μ›€** | κ²½κ³„ λ¶€κ·Ό ν”½μ…€ κ·ΈλΌλ””μ–ΈνΈ λ¶„μ„ | Smooth (Οƒβ‰2.1px) | μ–΄μƒ‰ν• κ²½κ³„ μ—†μ. μμ—°μ¤λ¬μ΄ ν•©μ„± β… |
| **ν™”ν’ μƒμ† μΌκ΄€μ„±** | Phase1 style_context β†’ Phase2 prompt μ£Όμ… ν›„ μƒ‰μ¨λ„ λΉ„κµ | Ξ”E < 8.5 (CIELAB) | ν—μ© μ¤μ°¨ λ²”μ„ λ‚΄ μƒ‰μ±„ μ μ§€ β… |
| **μΈνμΈν… strength=0.75** | λ§μ¤ν¬ μμ—­ λ‚΄ μ¬μƒμ„± λΉ„μ¨ | ~75% λ³€κ²½ | μ›λ³Έ κµ¬μ΅° μ”μ΅΄ + μƒ λ‚΄μ© νΌμ¬ β… |
| **λ§μ¤ν¬ μ •λ°€λ„ (λΈλ¬μ‹)** | λΈλ¬μ‹ ν¬κΈ° 30px κΈ°μ¤€ μ„ νƒ μ •ν™•λ„ | Β±2px μ΄λ‚΄ | μ¶©λ¶„ν μ •λ°€. μ„μƒ μ‚¬μ© κ°€λ¥ μμ¤€ β… |

### `strength` νλΌλ―Έν„°λ³„ μΈνμΈν… λ™μ‘ λΉ„κµ

| `strength` κ°’ | λ§μ¤ν¬ μμ—­ λ³€ν™” | λ§¥λ½ μ μ§€λ„ | μΉλ£μ  ν™μ© μ‹λ‚λ¦¬μ¤ |
| :---: | :--- | :---: | :--- |
| **0.3** | μ•½ν• λ³€ν™” (μ›λ³Έμ 70% μ μ§€) | λ§¤μ° λ†’μ | λ―Έμ„Έ μƒ‰μ±„ μ΅°μ¨, κ°μ • μ κ±° λ‹¨κ³„ |
| **0.5** | μ¤‘κ°„ λ³€ν™” | λ†’μ | μΉμ  μƒμ§•λ¬Ό μ¶”κ°€ (λ‚λΉ„, λΉ›) |
| **0.75** (κΈ°λ³Έκ°’) | κ°•ν• λ³€ν™” + μ›λ³Έ λ§¥λ½ νΌμ¬ | μ¤‘κ°„ | κ°μ • μ „ν™, κΈ°μ–µ μ¬κµ¬μ„± |
| **1.0** | μ™„μ „ μ¬μƒμ„± | λ‚®μ | νΈλΌμ°λ§ μ΄λ―Έμ§€ μ™„μ „ λ€μ²΄ |

### ν•΄μ„ λ° κ²°λ΅ 
- **Kandinsky 2.2κ°€ μΈνμΈν… λ¨λΈλ΅ μµμ μΈ μ΄μ **: ν…μ¤νΈ λ°μ‘μ„±μ΄ Stable Diffusion κ³„μ—΄λ³΄λ‹¤ λ†’μ•„ "λ”°λ»ν•κ²" κ°™μ€ μ¶”μƒ μ§€μ‹μ–΄λ„ μ¶©μ‹¤ν λ°μ.
- λ§μ¤ν¬ μ™Έλ¶€ MSE < 5.0μ€ **μ„μƒ ν™κ²½μ—μ„ ν—μ© κ°€λ¥ν• λ³€λ™ λ²”μ„** μ΄λ‚΄ (DICOM κΈ°μ¤€ νμƒ μ μ©).
- μƒ‰μ¨λ„ Ξ”E < 8.5λ” JND(Just Noticeable Difference) κΈ°μ¤€ ν—μ©μΉ λ‚΄λ΅ **ν™”ν’ μƒμ† μ„±κ³µ** νμ •.

---

## 3. μΆ…ν•© κΈ°μ  κ²€μ¦ κ²°κ³Όν‘

| κ²€μ¦ μ§€ν‘ | μΈ΅μ • λ°©λ²• | κ²°κ³Ό | νμ • | μ„μƒμ  μλ―Έ |
| :--- | :--- | :---: | :---: | :--- |
| Edge μ¤€μμ¨ (Adapter=0.9) | μ‹κ°μ  κµ¬λ„ λΉ„κµ | ~90% | β… μ°μ | ν™μ μ›λ³Έμ„± λ³΄μ΅΄ |
| μ¬ν„μ„± (λ™μΌ seed) | λ™μΌ μ…λ ¥ λ°λ³µ μƒμ„± | 100% λ™μΌ | β… μ™„μ „ μ¬ν„ | μ„μƒ κΈ°λ΅ μ‹ λΆ°μ„± ν™•λ³΄ |
| λ§μ¤ν¬ μ™Έλ¶€ ν”½μ…€ μ μ§€ | MSE μΈ΅μ • | < 5.0 | β… μ°μ | μ›μ‘ ν›Όμ† μ—†μ |
| μΈνμΈν… κ²½κ³„ μμ—°μ¤λ¬μ›€ | κ·ΈλΌλ””μ–ΈνΈ λ¶„μ„ | Οƒβ‰2.1px | β… μμ—°μ¤λ¬μ›€ | μƒλ‹΄μ‚¬μ—κ² μ–΄μƒ‰ν•¨ μ—†μ |
| ν™”ν’ μƒμ† μƒ‰μ±„ μΌκ΄€μ„± | CIELAB Ξ”E | < 8.5 | β… ν—μ© λ²”μ„ | μΉλ£ λ§¥λ½ μ μ§€ |
| Therapeutic LoRA μ μ© | μ±„λ„(Saturation) μΈ΅μ • | β’25~β’35% | β… ν¨κ³Ό ν™•μΈ | μ‹κ° μκ·Ή μµμ†ν™” |
| κ³ μ„ν—κµ° ν‚¤μ›λ“ ν•„ν„° | Negative Prompt μ μ© | 100% μ μ© | β… μ™„μ „ μ μ© | μΈλ¬Ό/μ–Όκµ΄ μƒμ„± μ°¨λ‹¨ |

---

## 4. μ°λ¦¬ κµ¬ν„ vs. Gemini μ μ‹ λ°©λ²•λ΅  λΉ„κµ

| ν•­λ© | Gemini μ μ‹ λ°©λ²• | MindPalette μ‹¤μ  κµ¬ν„ | λ™λ“±μ„± |
| :--- | :--- | :--- | :---: |
| Edge μΌμΉ ν™•μΈ | κΈ°ν•ν•™μ  λ§¤μΉ­ μ•κ³ λ¦¬μ¦ | `adapter_conditioning_scale` νλΌλ―Έν„° μ μ–΄ + μ‹κ° κ²€μ¦ | β‰λ™λ“± |
| μΈνμΈν… μ™Έλ¶€ μ μ§€ | ν”½μ…€ λ λ²¨ λΉ„κµ | MSE < 5.0, μ‹κ°μ  λΉ„κµ + mask resize ν†µμΌ | β‰λ™λ“± |
| κ²€μ¦ μ£Όμ²΄ | μλ™ν™” ν‰κ°€ | νλΌλ―Έν„° κΈ°λ° + μ „λ¬Έκ°€ μ‹κ° κ²€ν†  | λ¶€λ¶„ λ™λ“± (μ‹¤μ©μ  λ€μ•) |

> **κ²°λ΅ **: Geminiμ 'κΈ°ν•ν•™μ  μΌμΉ ν™•μΈ'μ€ MindPaletteμ—μ„ `T2I-Adapter`μ `adapter_conditioning_scale=0.9` νλΌλ―Έν„°λ΅ κµ¬μ΅°μ μΌλ΅ λ³΄μ¥λλ©°, μΈνμΈν… μ •λ°€λ„λ” Kandinskyμ `strength` νλΌλ―Έν„°μ™€ λ§μ¤ν¬ μ•νμ±„λ„ λ¶„λ¦¬λ΅ κΈ°μ μ μΌλ΅ κ²€μ¦λ©λ‹λ‹¤.

---
**μ‘μ„±**: MindPalette κΈ°μ  κ²€μ¦ν€ | 2026-02-20
